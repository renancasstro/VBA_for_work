Option Explicit

Public arr
Public arAlone
Public Index As Integer

Sub AG()

arr = Array("Alone", "OiT", "Fibra")
arAlone = Array("11", "12", "19", "20")

If Index < 4 Then
    Windows("Análise Gráfica_v4.xlsm").Activate
    Workbooks("Forecast_Operacional_v6.xlsx").Worksheets("Alone").Range("AB" & arAlone(Index)).Copy
    
    SendKeys "^+S"
    SendKeys "^V"
    SendKeys "~"

    Index = Index + 1
    
    Application.OnTime Now + TimeValue("00:00:05"), "Copy"
Else
    Index = 0
    MsgBox "Parabéns! Sua automação terminou com sucesso!"
End If

End Sub
Sub Copy()

Dim num As Double
Dim coluna As String
Dim ano As Integer

Windows("Análise Gráfica_v4.xlsm").Activate
coluna = Workbooks("Planilha de Automação.xlsm").Worksheets("Automações").Range("O8")
ano = Workbooks("Planilha de Automação.xlsm").Worksheets("Automações").Range("P8")
num = Range(coluna & ano)
coluna = Workbooks("Planilha de Automação.xlsm").Worksheets("Automações").Range("Q8")
Workbooks("Forecast_Operacional_v6.xlsx").Worksheets("Alone").Range(coluna & arAlone((Index - 1))) = num

Application.OnTime Now, "AG"

End Sub
